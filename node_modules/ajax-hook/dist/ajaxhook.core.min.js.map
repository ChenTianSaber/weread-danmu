{"version":3,"sources":["webpack:///ajaxhook.core.min.js","webpack:///webpack/bootstrap bb0c5faced0f3bfe4126?024e","webpack:///./src/xhr-hook.js?adec","webpack:///./src/cdn-core.js"],"names":["e","a","i","window","modules","__webpack_require__","moduleId","installedModules","exports","module","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","configEvent","event","xhrProxy","attr","target","currentTarget","hook","proxy","win","getterFactory","originValue","this","OriginXhr","hooking","v","attrGetterHook","setterFactory","xhr","that","substring","attrSetterHook","hookFunction","fun","args","slice","arguments","ret","apply","unHook","XMLHttpRequest","HookXMLHttpRequest","originXhr","constructor","undefined","events","length","key","type","set","getProxy","assign","UNSENT","OPENED","HEADERS_RECEIVED","LOADING","DONE","_typeof","Symbol","iterator","obj","ah"],"mappings":"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","file":"ajaxhook.core.min.js","sourcesContent":["(function(e, a) { for(var i in a) e[i] = a[i]; }(window, /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 2);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.configEvent = configEvent;\nexports.hook = hook;\n/*\n * author: wendux\n * email: 824783146@qq.com\n * source code: https://github.com/wendux/Ajax-hook\n */\n\nvar events = exports.events = ['load', 'loadend', 'timeout', 'error', 'readystatechange', 'abort'];\n\nvar OriginXhr = '__origin_xhr';\n\nfunction configEvent(event, xhrProxy) {\n  var e = {};\n  for (var attr in event) {\n    e[attr] = event[attr];\n  } // xhrProxy instead\n  e.target = e.currentTarget = xhrProxy;\n  return e;\n}\n\nfunction hook(proxy, win) {\n  win = win || window;\n  var originXhr = win.XMLHttpRequest;\n\n  var hooking = true;\n\n  var HookXMLHttpRequest = function HookXMLHttpRequest() {\n    // We shouldn't hookAjax XMLHttpRequest.prototype because we can't\n    // guarantee that all attributes are on the prototype。\n    // Instead, hooking XMLHttpRequest instance can avoid this problem.\n\n    var xhr = new originXhr();\n\n    // Generate all callbacks(eg. onload) are enumerable (not undefined).\n    for (var i = 0; i < events.length; ++i) {\n      var key = 'on' + events[i];\n      if (xhr[key] === undefined) xhr[key] = null;\n    }\n\n    for (var attr in xhr) {\n      var type = \"\";\n      try {\n        type = _typeof(xhr[attr]); // May cause exception on some browser\n      } catch (e) {}\n      if (type === \"function\") {\n        // hookAjax methods of xhr, such as `open`、`send` ...\n        this[attr] = hookFunction(attr);\n      } else if (attr !== OriginXhr) {\n        Object.defineProperty(this, attr, {\n          get: getterFactory(attr),\n          set: setterFactory(attr),\n          enumerable: true\n        });\n      }\n    }\n    var that = this;\n    xhr.getProxy = function () {\n      return that;\n    };\n    this[OriginXhr] = xhr;\n  };\n\n  HookXMLHttpRequest.prototype = originXhr.prototype;\n  HookXMLHttpRequest.prototype.constructor = HookXMLHttpRequest;\n\n  win.XMLHttpRequest = HookXMLHttpRequest;\n\n  Object.assign(win.XMLHttpRequest, { UNSENT: 0, OPENED: 1, HEADERS_RECEIVED: 2, LOADING: 3, DONE: 4 });\n\n  // Generate getter for attributes of xhr\n  function getterFactory(attr) {\n    return function () {\n      var originValue = this[OriginXhr][attr];\n      if (hooking) {\n        var v = this.hasOwnProperty(attr + \"_\") ? this[attr + \"_\"] : originValue;\n        var attrGetterHook = (proxy[attr] || {})[\"getter\"];\n        return attrGetterHook && attrGetterHook(v, this) || v;\n      } else {\n        return originValue;\n      }\n    };\n  }\n\n  // Generate setter for attributes of xhr; by this we have an opportunity\n  // to hookAjax event callbacks （eg: `onload`） of xhr;\n  function setterFactory(attr) {\n    return function (v) {\n      var xhr = this[OriginXhr];\n      if (hooking) {\n        var that = this;\n        var hook = proxy[attr];\n        // hookAjax  event callbacks such as `onload`、`onreadystatechange`...\n        if (attr.substring(0, 2) === 'on') {\n          that[attr + \"_\"] = v;\n          xhr[attr] = function (e) {\n            e = configEvent(e, that);\n            var ret = proxy[attr] && proxy[attr].call(that, xhr, e);\n            ret || v.call(that, e);\n          };\n        } else {\n          //If the attribute isn't writable, generate proxy attribute\n          var attrSetterHook = (hook || {})[\"setter\"];\n          v = attrSetterHook && attrSetterHook(v, that) || v;\n          this[attr + \"_\"] = v;\n          try {\n            // Not all attributes of xhr are writable(setter may undefined).\n            xhr[attr] = v;\n          } catch (e) {}\n        }\n      } else {\n        xhr[attr] = v;\n      }\n    };\n  }\n\n  // Hook methods of xhr.\n  function hookFunction(fun) {\n    return function () {\n      var args = [].slice.call(arguments);\n      if (proxy[fun] && hooking) {\n        var ret = proxy[fun].call(this, args, this[OriginXhr]);\n        // If the proxy return value exists, return it directly,\n        // otherwise call the function of xhr.\n        if (ret) return ret;\n      }\n      return this[OriginXhr][fun].apply(this[OriginXhr], args);\n    };\n  }\n\n  function unHook() {\n    hooking = false;\n    if (win.XMLHttpRequest === HookXMLHttpRequest) {\n      win.XMLHttpRequest = originXhr;\n      HookXMLHttpRequest.prototype.constructor = originXhr;\n      originXhr = undefined;\n    }\n  }\n\n  // Return the real XMLHttpRequest and unHook func\n  return { originXhr: originXhr, unHook: unHook };\n}\n\n/***/ }),\n/* 1 */,\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ah = undefined;\n\nvar _xhrHook = __webpack_require__(0);\n\nvar ah = exports.ah = { hook: _xhrHook.hook }; /*\n                                                * author: wendux\n                                                * email: 824783146@qq.com\n                                                * source code: https://github.com/wendux/Ajax-hook\n                                                */\n\n/***/ })\n/******/ ])));\n\n\n// WEBPACK FOOTER //\n// ajaxhook.core.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bb0c5faced0f3bfe4126","/*\n * author: wendux\n * email: 824783146@qq.com\n * source code: https://github.com/wendux/Ajax-hook\n */\n\nexport var events = ['load', 'loadend', 'timeout', 'error', 'readystatechange', 'abort'];\n\nvar OriginXhr = '__origin_xhr';\n\nexport function configEvent(event, xhrProxy) {\n  var e = {};\n  for (var attr in event) e[attr] = event[attr];\n  // xhrProxy instead\n  e.target = e.currentTarget = xhrProxy\n  return e;\n}\n\nexport function hook(proxy, win) {\n  win = win || window;\n  var originXhr = win.XMLHttpRequest;\n\n  var hooking = true;\n\n  var HookXMLHttpRequest = function () {\n    // We shouldn't hookAjax XMLHttpRequest.prototype because we can't\n    // guarantee that all attributes are on the prototype。\n    // Instead, hooking XMLHttpRequest instance can avoid this problem.\n\n    var xhr = new originXhr();\n\n    // Generate all callbacks(eg. onload) are enumerable (not undefined).\n    for (var i = 0; i < events.length; ++i) {\n      var key='on'+events[i];\n      if (xhr[key] === undefined) xhr[key] = null;\n    }\n\n    for (var attr in xhr) {\n      var type = \"\";\n      try {\n        type = typeof xhr[attr] // May cause exception on some browser\n      } catch (e) {\n      }\n      if (type === \"function\") {\n        // hookAjax methods of xhr, such as `open`、`send` ...\n        this[attr] = hookFunction(attr);\n      } else if (attr !== OriginXhr) {\n        Object.defineProperty(this, attr, {\n          get: getterFactory(attr),\n          set: setterFactory(attr),\n          enumerable: true\n        }) \n      }\n    }\n    var that = this;\n    xhr.getProxy = function () {\n      return that\n    }\n    this[OriginXhr] = xhr;\n  }\n\n  HookXMLHttpRequest.prototype = originXhr.prototype;\n  HookXMLHttpRequest.prototype.constructor = HookXMLHttpRequest;\n\n  win.XMLHttpRequest = HookXMLHttpRequest;\n\n  Object.assign(win.XMLHttpRequest, {UNSENT: 0, OPENED: 1, HEADERS_RECEIVED: 2, LOADING: 3, DONE: 4});\n\n  // Generate getter for attributes of xhr\n  function getterFactory(attr) {\n    return function () {\n      var originValue = this[OriginXhr][attr];\n      if (hooking) {\n        var v = this.hasOwnProperty(attr + \"_\") ? this[attr + \"_\"] : originValue;\n        var attrGetterHook = (proxy[attr] || {})[\"getter\"];\n        return attrGetterHook && attrGetterHook(v, this) || v;\n      } else {\n        return originValue;\n      }\n    }\n  }\n\n  // Generate setter for attributes of xhr; by this we have an opportunity\n  // to hookAjax event callbacks （eg: `onload`） of xhr;\n  function setterFactory(attr) {\n    return function (v) {\n      var xhr = this[OriginXhr];\n      if (hooking) {\n        var that = this;\n        var hook = proxy[attr];\n        // hookAjax  event callbacks such as `onload`、`onreadystatechange`...\n        if (attr.substring(0, 2) === 'on') {\n          that[attr + \"_\"] = v;\n          xhr[attr] = function (e) {\n            e = configEvent(e, that)\n            var ret = proxy[attr] && proxy[attr].call(that, xhr, e)\n            ret || v.call(that, e);\n          }\n        } else {\n          //If the attribute isn't writable, generate proxy attribute\n          var attrSetterHook = (hook || {})[\"setter\"];\n          v = attrSetterHook && attrSetterHook(v, that) || v\n          this[attr + \"_\"] = v;\n          try {\n            // Not all attributes of xhr are writable(setter may undefined).\n            xhr[attr] = v;\n          } catch (e) {\n          }\n        }\n      } else {\n        xhr[attr] = v;\n      }\n    }\n  }\n\n  // Hook methods of xhr.\n  function hookFunction(fun) {\n    return function () {\n      var args = [].slice.call(arguments);\n      if (proxy[fun] && hooking) {\n        var ret = proxy[fun].call(this, args, this[OriginXhr])\n        // If the proxy return value exists, return it directly,\n        // otherwise call the function of xhr.\n        if (ret) return ret;\n      }\n      return this[OriginXhr][fun].apply(this[OriginXhr], args);\n    }\n  }\n\n  function unHook() {\n      hooking = false;\n      if (win.XMLHttpRequest === HookXMLHttpRequest) {\n        win.XMLHttpRequest = originXhr;\n        HookXMLHttpRequest.prototype.constructor = originXhr;\n        originXhr = undefined;\n      }\n  }\n\n  // Return the real XMLHttpRequest and unHook func\n  return { originXhr, unHook  };\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/xhr-hook.js","/*\n * author: wendux\n * email: 824783146@qq.com\n * source code: https://github.com/wendux/Ajax-hook\n */\n\nimport { hook } from \"./xhr-hook\";\n\nexport var ah = { hook };\n\n\n\n// WEBPACK FOOTER //\n// ./src/cdn-core.js"],"sourceRoot":""}